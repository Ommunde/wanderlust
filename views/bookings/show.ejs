<% layout("layouts/boilerplate") %>

<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-lg-8 col-md-10 col-sm-12">
      <div class="card shadow-sm border-0 rounded-4">
        <div class="card-header bg-success text-white rounded-top-4">
          <h3 class="mb-0"><i class="fa-solid fa-check-circle me-2"></i>Booking Confirmed!</h3>
        </div>
        <div class="card-body p-4">
          <div class="row mb-4">
            <div class="col-md-6">
              <img src="<%= booking.listing.image.url %>" class="img-fluid rounded-3" alt="<%= booking.listing.title %>">
            </div>
            <div class="col-md-6">
              <h4><%= booking.listing.title %></h4>
              <p class="text-muted">
                <i class="fa-solid fa-location-dot me-1"></i>
                <%= booking.listing.location %>, <%= booking.listing.country %>
              </p>
              <p class="text-muted">
                <i class="fa-solid fa-indian-rupee-sign me-1"></i>
                Price per night: ₹<%= booking.listing.price.toLocaleString("en-IN") %>
              </p>
            </div>
          </div>
          
          <hr>
          
          <h5 class="mb-3">Booking Details</h5>
          <ul class="list-group list-group-flush mb-4">
            <li class="list-group-item d-flex justify-content-between">
              <span><i class="fa-solid fa-calendar-days me-2"></i>Check-in Date:</span>
              <strong><%= booking.checkIn.toLocaleDateString() %></strong>
            </li>
            <li class="list-group-item d-flex justify-content-between">
              <span><i class="fa-solid fa-calendar-days me-2"></i>Check-out Date:</span>
              <strong><%= booking.checkOut.toLocaleDateString() %></strong>
            </li>
            <li class="list-group-item d-flex justify-content-between">
              <span><i class="fa-solid fa-moon me-2"></i>Number of Nights:</span>
              <strong><%= Math.ceil((booking.checkOut - booking.checkIn) / (1000 * 60 * 60 * 24)) %> nights</strong>
            </li>
            <li class="list-group-item d-flex justify-content-between">
              <span><i class="fa-solid fa-users me-2"></i>Number of Guests:</span>
              <strong><%= booking.guests %></strong>
            </li>
            <li class="list-group-item d-flex justify-content-between">
              <span><i class="fa-solid fa-tag me-2"></i>Status:</span>
              <% if (booking.status === "confirmed") { %>
                <span class="badge bg-success">Confirmed</span>
              <% } else if (booking.status === "cancelled") { %>
                <span class="badge bg-danger">Cancelled</span>
              <% } else { %>
                <span class="badge bg-warning">Pending</span>
              <% } %>
            </li>
            <li class="list-group-item d-flex justify-content-between">
              <span><i class="fa-solid fa-indian-rupee-sign me-2"></i>Total Price:</span>
              <strong class="text-success fs-5">₹<%= booking.totalPrice.toLocaleString("en-IN") %></strong>
            </li>
          </ul>
          
          <div class="d-flex gap-2">
            <a href="/bookings" class="btn btn-outline-primary">
              <i class="fa-solid fa-list me-2"></i>View All Bookings
            </a>
            <a href="/listings/<%= booking.listing._id %>" class="btn btn-outline-secondary">
              <i class="fa-solid fa-arrow-left me-2"></i>Back to Listing
            </a>
            <% if (booking.status === "confirmed") { %>
              <form method="POST" action="/bookings/<%= booking._id %>?_method=DELETE" class="ms-auto">
                <button type="submit" class="btn btn-outline-danger" onclick="return confirm('Are you sure you want to cancel this booking?')">
                  <i class="fa-solid fa-times me-2"></i>Cancel Booking
                </button>
              </form>
            <% } %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
